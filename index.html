<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GustoCode</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm/css/xterm.css" />
<style>
  * { box-sizing: border-box; }
  html, body { height:100%; margin:0; background:#1e1e1e; color:#d4d4d4; font-family:'Fira Code', monospace; display:flex; flex-direction:column; }

  #topbar {
    height:40px; background:#333; display:flex; align-items:center; justify-content:space-between;
    padding:0 10px; color:#fff; font-weight:bold; border-bottom:1px solid #444;
  }
  #topbar button {
    background:#007acc; border:none; color:#fff; padding:6px 12px;
    border-radius:4px; cursor:pointer; font-weight:bold; transition:0.3s;
  }
  #topbar button:hover { background:#005fa3; }

  #container { flex:1; display:flex; min-height:0; }
  #sidebar {
    width:60px; background:#252526; display:flex; flex-direction:column;
    align-items:center; padding-top:10px; border-right:1px solid #333;
  }
  .icon {
    width:30px; height:30px; margin:10px 0; cursor:pointer;
    display:flex; align-items:center; justify-content:center; color:#ccc;
    transition:0.3s;
  }
  .icon:hover { color:#fff; }

  #main { flex:1; display:flex; flex-direction:column; }
  #tabs { height:30px; background:#2d2d2d; display:flex; align-items:center; padding:0 5px; border-bottom:1px solid #333; overflow-x:auto; }
  .tab { padding:0 10px; cursor:pointer; color:#ccc; margin-right:5px; }
  .tab.active { background:#1e1e1e; color:#fff; border-radius:3px; }

  #editor { flex:1; min-height:0; }

  #terminal {
    height:150px; background:#1e1e1e; border-top:1px solid #333;
  }

  #statusbar {
    height:25px; background:#007acc; color:white; display:flex; align-items:center; padding:0 10px; font-size:13px;
  }

  @media (max-width:700px){
    #sidebar { width:50px; }
    #topbar button { padding:4px 8px; font-size:12px; }
    .tab { font-size:12px; }
  }
</style>
</head>
<body>
  <div id="topbar">
    <span>üß† GustoCode</span>
    <button onclick="runCode()">‚ñ∂ Executar</button>
  </div>

  <div id="container">
    <div id="sidebar">
      <div class="icon" title="Explorador">üìÅ</div>
      <div class="icon" title="Busca">üîç</div>
      <div class="icon" title="Controle de C√≥digo">üß©</div>
      <div class="icon" title="Execu√ß√£o">‚öôÔ∏è</div>
      <div class="icon" title="Extens√µes">üß†</div>
    </div>

    <div id="main">
      <div id="tabs"></div>
      <div id="editor"></div>
      <div id="terminal"></div>
      <div id="statusbar">Conectado - GustoCode Web</div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xterm/lib/xterm.js"></script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.2/full/pyodide.js"></script>

<script>
let editor, term;
let files = {
  "index.html": "<!DOCTYPE html>\\n<html>\\n<body>\\n<h1>Ol√°, GustoCode!</h1>\\n</body>\\n</html>",
  "style.css": "body { background:#fff; color:#000; }",
  "script.js": "console.log('Ol√°, Augusto!');",
  "python.py": "print('Ol√° do Python no GustoCode!')"
};
let currentFile = "index.html";

require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs' }});
require(["vs/editor/editor.main"], function() {
  editor = monaco.editor.create(document.getElementById("editor"), {
    value: files[currentFile],
    language: "html",
    theme: "vs-dark",
    automaticLayout: true
  });
  createTabs();
});

function createTabs(){
  const tabs = document.getElementById("tabs");
  tabs.innerHTML = "";
  for(let f in files){
    const tab = document.createElement("div");
    tab.className = "tab" + (f===currentFile ? " active":"");
    tab.textContent = f;
    tab.onclick = ()=>openFile(f);
    tabs.appendChild(tab);
  }
}

function openFile(name){
  currentFile = name;
  editor.setValue(files[name]);
  let lang = "plaintext";
  if(name.endsWith(".js")) lang="javascript";
  else if(name.endsWith(".html")) lang="html";
  else if(name.endsWith(".css")) lang="css";
  else if(name.endsWith(".py")) lang="python";
  monaco.editor.setModelLanguage(editor.getModel(), lang);
  createTabs();
}

term = new Terminal({ theme: { background:"#1e1e1e", foreground:"#d4d4d4" } });
term.open(document.getElementById("terminal"));
term.writeln("üöÄ Terminal do GustoCode pronto!");

async function runCode(){
  const code = editor.getValue();
  if(currentFile.endsWith(".js")){
    try{ eval(code); term.writeln("‚úÖ JavaScript executado!"); }
    catch(e){ term.writeln("‚ùå Erro JS: "+e); }
  } else if(currentFile.endsWith(".html")){
    const w = window.open();
    w.document.write(code); w.document.close();
    term.writeln("üåê HTML aberto em nova aba!");
  } else if(currentFile.endsWith(".css")){
    const style = document.createElement("style");
    style.textContent = code;
    document.head.appendChild(style);
    term.writeln("üé® CSS aplicado!");
  } else if(currentFile.endsWith(".py")){
    term.writeln("üêç Executando Python com Pyodide...");
    if(!window.pyodide) pyodide = await loadPyodide();
    try {
      const result = await pyodide.runPythonAsync(code);
      term.writeln(result ?? "‚úÖ Python executado!");
    } catch(e){
      term.writeln("‚ùå Erro Python: "+e);
    }
  } else {
    term.writeln("‚ö†Ô∏è Tipo de arquivo n√£o suportado!");
  }
}
</script>
</body>
  </html>
